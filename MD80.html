
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MD80 &#8212; MD80 x CANdle Manual</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/logo32x32.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CANdle and CANdle HAT" href="CANdle.html" />
    <link rel="prev" title="Ecosystem overview" href="Ecosystem.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MD80 x CANdle Manual</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    MD80 x CANdle Manual
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="QuickStartGuide.html">
   Quick Start Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Ecosystem.html">
   MD80 x CANdle Ecosystem overview
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   MD80 controller
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CANdle.html">
   CANdle and CANdle HAT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Software.html">
   Software package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="canProtocol.html">
   MD80 FDCAN protocol
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="CANopen.html">
   MD80 CANopen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="OD.html">
     Object Dictionary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FAQ.html">
   Common problems and FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Downloads.html">
   Downloads
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMD80.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/MD80.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-parameters">
   General parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#connectors-pinout">
   Connectors pinout
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-modes">
   Control modes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-pid">
     Velocity PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#position-pid">
     Position PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#impedance-pd">
     Impedance PD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#controller-implementation">
     Controller implementation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motion-controller-tuning">
   Motion controller tuning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Velocity PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Position PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Impedance PD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#current-pi">
     Current PI
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#safety-limits">
   Safety limits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fdcan-watchdog">
   FDCAN Watchdog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measurements">
   Measurements
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#position">
     Position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity">
     Velocity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#torque">
     Torque
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-encoder">
   Output Encoder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calibration">
   Calibration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pole-pairs-detection">
     Pole pairs detection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encoder-eccentricity">
     Encoder eccentricity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motor-resistance-and-inductance">
     Motor resistance and inductance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#torque-bandwidth">
     Torque bandwidth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-encoder-calibration">
   Output Encoder Calibration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#error-codes">
   Error Codes
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>MD80</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-parameters">
   General parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#connectors-pinout">
   Connectors pinout
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-modes">
   Control modes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-pid">
     Velocity PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#position-pid">
     Position PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#impedance-pd">
     Impedance PD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#controller-implementation">
     Controller implementation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motion-controller-tuning">
   Motion controller tuning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Velocity PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Position PID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Impedance PD
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#current-pi">
     Current PI
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#safety-limits">
   Safety limits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fdcan-watchdog">
   FDCAN Watchdog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measurements">
   Measurements
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#position">
     Position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity">
     Velocity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#torque">
     Torque
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-encoder">
   Output Encoder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calibration">
   Calibration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pole-pairs-detection">
     Pole pairs detection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encoder-eccentricity">
     Encoder eccentricity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motor-resistance-and-inductance">
     Motor resistance and inductance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#torque-bandwidth">
     Torque bandwidth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-encoder-calibration">
   Output Encoder Calibration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#error-codes">
   Error Codes
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="md80">
<h1>MD80<a class="headerlink" href="#md80" title="Permalink to this headline">#</a></h1>
<section id="general-parameters">
<h2>General parameters<a class="headerlink" href="#general-parameters" title="Permalink to this headline">#</a></h2>
<p>MD80 is a brushless motor controller. It can work with a variety of motors and reducers that can be precisely matched to the users’ specifications. All MD80 variants are using an advanced motor control algorithm (FOC), a high-resolution encoder, a high-speed FDCAN communication bus, and a common communication interface. The servo drives have an integrated high-frequency position PID controller, velocity PID controller, and impedance controller, as well as a direct torque controller. MD80 also features a daisy-chaining mechanism, for easy connection of many drives in a single control network.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can easily check your MD80 version using the <a class="reference internal" href="Software.html#mdtool-setup-info"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">info</span></code></span></a> command.</p>
</div>
<p id="ratings"><strong>General parameters table for MD80 HW1.1, HV1.3 and older:</strong></p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Input Voltage</p></td>
<td><p>18 - 28 VDC</p></td>
</tr>
<tr class="row-odd"><td><p>Nominal Input Voltage</p></td>
<td><p>24 VDC</p></td>
</tr>
<tr class="row-even"><td><p>Max Input Current</p></td>
<td><p>10 A</p></td>
</tr>
<tr class="row-odd"><td><p>Max Continuous Phase Current</p></td>
<td><p>20 A</p></td>
</tr>
<tr class="row-even"><td><p>Max Peak Phase Current (t = 4 s)</p></td>
<td><p>40 A</p></td>
</tr>
<tr class="row-odd"><td><p>FDCAN Baudrate (adjustable)</p></td>
<td><p>1/2/5/8 Mbps</p></td>
</tr>
<tr class="row-even"><td><p>Position PID Controller Execution Frequency</p></td>
<td><p>1 kHz</p></td>
</tr>
<tr class="row-odd"><td><p>Velocity PID Controller Execution Frequency</p></td>
<td><p>5 kHz</p></td>
</tr>
<tr class="row-even"><td><p>Impedance Controller ExecutionFrequency</p></td>
<td><p>40 kHz</p></td>
</tr>
<tr class="row-odd"><td><p>Torque Control Execution Frequency</p></td>
<td><p>40 kHz</p></td>
</tr>
<tr class="row-even"><td><p>Torque Bandwidth (adjustable)</p></td>
<td><p>50 Hz - 2.5 kHz</p></td>
</tr>
</tbody>
</table>
<p><strong>General parameters table for MD80 V2.0:</strong></p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><b><font color="#008000">Input Voltage</font></b></p></td>
<td><p><b><font color="#008000">10 - 48 VDC</font></b></p></td>
</tr>
<tr class="row-odd"><td><p>Nominal Input Voltage</p></td>
<td><p>24 VDC</p></td>
</tr>
<tr class="row-even"><td><p>Max Input Current</p></td>
<td><p>10 A</p></td>
</tr>
<tr class="row-odd"><td><p>Max Continuous Phase Current</p></td>
<td><p>20 A</p></td>
</tr>
<tr class="row-even"><td><p><b><font color="#008000">Max Peak Phase Current (t = 2 s)</font></b></p></td>
<td><p><b><font color="#008000">80 A</font></b></p></td>
</tr>
<tr class="row-odd"><td><p><b><font color="#008000">Built-in software-controlled termination resistor</font></b></p></td>
<td><p><b><font color="#008000">yes</font></b></p></td>
</tr>
<tr class="row-even"><td><p>FDCAN Baudrate (adjustable)</p></td>
<td><p>1/2/5/8 Mbps</p></td>
</tr>
<tr class="row-odd"><td><p>Position PID Controller Execution Frequency</p></td>
<td><p>1 kHz</p></td>
</tr>
<tr class="row-even"><td><p>Velocity PID Controller Execution Frequency</p></td>
<td><p>5 kHz</p></td>
</tr>
<tr class="row-odd"><td><p>Impedance Controller ExecutionFrequency</p></td>
<td><p>40 kHz</p></td>
</tr>
<tr class="row-even"><td><p>Torque Control Execution Frequency</p></td>
<td><p>40 kHz</p></td>
</tr>
<tr class="row-odd"><td><p>Torque Bandwidth (adjustable)</p></td>
<td><p>50 Hz - 2.5 kHz</p></td>
</tr>
<tr class="row-even"><td><p><b><font color="#008000">External encoder connector (SPI, RS422)</font></b></p></td>
<td><p><b><font color="#008000">yes</font></b></p></td>
</tr>
<tr class="row-odd"><td><p><b><font color="#008000">External 5V power supply max current</font></b></p></td>
<td><p><b><font color="#008000">150 mA</font></b></p></td>
</tr>
</tbody>
</table>
</section>
<section id="connectors-pinout">
<h2>Connectors pinout<a class="headerlink" href="#connectors-pinout" title="Permalink to this headline">#</a></h2>
<p>The connectors used in the system on the CAN FD side are MOLEX Micro-Fit series 3.0. Both connectors are connected in parallel for easy daisy-chaining. The connector pinout is presented below:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/can_connector_output.png" />
</figure>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/motor_connectors.jpg" />
</figure>
<p>The colors of the corresponding wires in the Molex socket, as supplied by MAB (looking from the side of the wires):</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/cable_colors.png" />
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><font color='red'> Always make sure CAN bus lines are not shorted to the positive power rail. Applying supply voltage to these pins will cause permanent damage to the controller! </font></p>
</div>
<p>All MD80 versions have the capability to measure the MOSFET and motor temperature. This is to ensure the safe operation of the driver and motor. The motor shutdown temperature is configurable up to 140<span class="math notranslate nohighlight">\(^\circ\)</span>C max with a hysteresis of 20<span class="math notranslate nohighlight">\(^\circ\)</span>C. The driver shutdown temperature is fixed at 100<span class="math notranslate nohighlight">\(^\circ\)</span>C with a hysteresis of 20<span class="math notranslate nohighlight">\(^\circ\)</span>C.</p>
<p>The connectors in the case of the HW1.1 and HV1.3 versions are located as follows:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/HW11_thermistor.png" style="width: 373.2px; height: 471.59999999999997px;" />
</figure>
<p>In the case of the MD80 HW V2.0 the MOSFET thermistor is built-in directly under the power stage and only the motor thermistor connector is available:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/HW20_thermistor.png" style="width: 542.0px; height: 302.0px;" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend using NTCMHP100K thermistors, as internally the MD80s are using a lookup table compatible with these sensors. Using other thermistors may result in imprecise temperature readout.</p>
</div>
<p>Since version HW V2.0 the PCB is equipped with an auxiliary connector (picoblade series connector 53048-0650 compatible with 797580006 and 510210600) for communication with <a class="reference internal" href="#output-encoder"><span class="std std-ref">output encoders</span></a>. The connector pinout is available below:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/aux_pinout.png" />
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><font color='red'>The auxiliary connector pins are 3.3V tolerant. Applying 5V to these pins will cause permanent damage to the controller! </font></p>
</div>
<p>External connector pin functions (RS422 / SPI) are selectable using resistors on the bottom PCB side. We are able to integrate custom functions such as GPIOs for external sensors and indicators. For more information please contact us: <a class="reference external" href="https://www.mabrobotics.pl/contact">contact&#64;mabrobotics.pl</a></p>
</section>
<section id="control-modes">
<h2>Control modes<a class="headerlink" href="#control-modes" title="Permalink to this headline">#</a></h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>TL;DR: <a class="reference external" href="https://www.youtube.com/watch?v=XnD8sG22zro&amp;t=0s">MD80 x CANdle - motion modes</a></p>
</div>
<p>To control the motor shaft with the user’s command MD80 is equipped with multiple control loops. All controllers are based on a regular PID controller design with an anti-windup block. The saturator (anti-windup) is an additional module that acts as a limiter to the ‘I’ part of the controller, as in many systems, the error integration may grow to very large numbers, completely overwhelming ‘P’ and ‘D’ parts of the controller.</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/limiters.png" />
</figure>
<section id="velocity-pid">
<h3>Velocity PID<a class="headerlink" href="#velocity-pid" title="Permalink to this headline">#</a></h3>
<p>Velocity PID controller calculates velocity error based on target velocity (set by user) and estimated velocity read from the encoder. Its output is a torque command for the internal current/torque controller. The parameters of the controller are:</p>
<ul class="simple">
<li><p>Velocity Target (in [rad/s])</p></li>
<li><p>kP (proportional gain)</p></li>
<li><p>kI (integral gain)</p></li>
<li><p>kD (derivative gain)</p></li>
<li><p>I windup (maximal output of an integral part in[Nm])</p></li>
<li><p>Max output (in [Nm])</p></li>
</ul>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/velocity_pid.png" />
</figure>
</section>
<section id="position-pid">
<h3>Position PID<a class="headerlink" href="#position-pid" title="Permalink to this headline">#</a></h3>
<p>Position PID mode is the most common controller mode used in industrial servo applications. In MD80, it is implemented as a cascaded PID controller. This means that the controller is working in two stages, firstly the position error is calculated, and it is then passed to the Position PID, which outputs the target velocity. This value is then passed as an input to the Velocity PID controller, which outputs commanded torque. This mode uses both Position PID and Velocity PID and thus needs the following parameters:</p>
<p>For Position PID:</p>
<ul class="simple">
<li><p>Position Target (in [rad])</p></li>
<li><p>kP (proportional gain)</p></li>
<li><p>kI (integral gain)</p></li>
<li><p>kD (derivative gain)</p></li>
<li><p>I windup (maximal output of an integral part in [rad/s])</p></li>
<li><p>Max output (in [rad/s])</p></li>
</ul>
<p>For Velocity PID:</p>
<ul class="simple">
<li><p>Velocity Target (in [rad/s])</p></li>
<li><p>kP (proportional gain)</p></li>
<li><p>kI (integral gain)</p></li>
<li><p>kD (derivative gain)</p></li>
<li><p>I windup (maximal output of an integral part in[Nm])</p></li>
<li><p>Max output (in [Nm])</p></li>
</ul>
<p>To properly tune the controller, it is recommended to first tune the velocity controller (in velocity PID mode), and then the position PID. The controller can be described with a diagram:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/position_pid.png" />
</figure>
</section>
<section id="impedance-pd">
<h3>Impedance PD<a class="headerlink" href="#impedance-pd" title="Permalink to this headline">#</a></h3>
<p>Impedance Control mode is a popular choice for mobile or legged robots, as well as for any compliant mechanism. The main idea behind it is to mimic the behavior of a torsional spring with variable stiffness and damping. The parameters of the controller are:</p>
<ul class="simple">
<li><p>Position Target</p></li>
<li><p>Velocity Target</p></li>
<li><p>kP (position gain)</p></li>
<li><p>kD (velocity gain)</p></li>
<li><p>Torque Feed Forward (Torque FF)</p></li>
</ul>
<p>The torque output is proportional to the position error and velocity error and additionally supplemented with a torque command from the user. Here are some of the most common applications for this control mode:</p>
<ul class="simple">
<li><p><b>Spring-damper mechanism</b> - when velocity target is set to 0, impedance controllers kP gain acts as the virtual spring stiffness and kD as its damping coefficient.
Example use case: a variable suspension for a wheeled robot, where suspension stiffness can be regulated by kP, damping by kD, and height (clearance) by changing the target position;</p></li>
<li><p><b>High-frequency torque controller</b>, where its targets and gains can act as stabilizing agents to the torque command.
Example use case: In legged robots, force control can be achieved by advanced control algorithms, which usually operate at rates below 100 Hz. It is usually enough to stabilize the robot but too slow to avoid vibrations. Knowing desired robot’s joint positions, velocities, and torques, drives can be set to produce the proper torque and hold the position/velocity with small gains. This would compensate for any high-frequency oscillations (vibrations) that may occur, as the impedance controller works at 40kHz (much faster than &lt;100 Hz).</p></li>
<li><p><b>Raw torque controller</b> - when kP and kD are set to zero, the torque_ff command is equal to the output controller torque.</p></li>
</ul>
<p>The impedance controller is relatively simple and works according to the schematic below:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/impedance.png" />
</figure>
</section>
<section id="controller-implementation">
<h3>Controller implementation<a class="headerlink" href="#controller-implementation" title="Permalink to this headline">#</a></h3>
<p>Controller implementation can be useful for simulating the actuators in virtual environments. Please find the PID and impedance C/C++ language implementations below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">mab_controller_performPid</span><span class="p">(</span><span class="n">PID_controller</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="nb">float</span> <span class="n">act_value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">error_last</span> <span class="o">=</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">error</span><span class="p">;</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">=</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">target</span> <span class="o">-</span> <span class="n">act_value</span><span class="p">;</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator</span> <span class="o">+=</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">error</span><span class="o">*</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">dt</span><span class="p">;</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator</span> <span class="o">=</span> <span class="n">mab_commons_range</span><span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator_windup</span><span class="p">,</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator_windup</span><span class="p">);</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">de</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">-</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">error_last</span><span class="p">)</span><span class="o">/</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">dt</span><span class="p">;</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">mab_commons_range</span><span class="p">(</span> <span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">kp</span> <span class="o">*</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">error</span> <span class="o">+</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">ki</span> <span class="o">*</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">integrator</span> <span class="o">+</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">kd</span> <span class="o">*</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">de</span><span class="p">)</span> <span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">output_max</span><span class="p">,</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">output_max</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span> <span class="n">mab_controller_performImpedanceController</span><span class="p">(</span><span class="n">Impedance_controller</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="nb">float</span> <span class="n">position</span><span class="p">,</span> <span class="nb">float</span> <span class="n">velocity</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">setTorque</span> <span class="o">+</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">kp</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">positionTarget</span> <span class="o">-</span> <span class="n">position</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">kd</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">velocityTarget</span> <span class="o">-</span> <span class="n">velocity</span><span class="p">);</span>
	<span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span> <span class="o">=</span> <span class="n">mab_commons_range</span><span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">,</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">outputMax</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="motion-controller-tuning">
<span id="id1"></span><h2>Motion controller tuning<a class="headerlink" href="#motion-controller-tuning" title="Permalink to this headline">#</a></h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The best way to get started with tuning is to copy the <a class="reference external" href="https://2d033567-d193-42c8-9e42-4931131b206f.usrfiles.com/ugd/2d0335_4f52c3bdab9e4b1cbd2cec68e48b7e14.pdf">default gains</a> and tweak them. You can treat this section as our recommendation for tuning the controllers, but online articles can be useful as well <a class="reference external" href="https://www.motioncontroltips.com/how-are-servo-system-velocity-control-loops-tuned/">(link)</a></p>
</div>
<p>The first step to correctly set up the gains is to start with our <a class="reference external" href="https://2d033567-d193-42c8-9e42-4931131b206f.usrfiles.com/ugd/2d0335_4f52c3bdab9e4b1cbd2cec68e48b7e14.pdf">default gains</a>. There are three sets of default gains that are set on each motor power up and thus they allow for restoring the actuator to a default state in case some gains were set incorrectly by the user. These gains are also a great starting point for user modifications when the actuator has to be used in a specific application requiring high positioning accuracy or very dynamic movements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default gains are set to work with CANdle examples. This way they can be assumed to be universal but it does not have to always be the case</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When something does go wrong during the tuning process just power-cycle the actuator - the default gains will be restored.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Always keep your safety limits low when experimenting with gains. Gains not suitable for your system may cause oscillations and unstable operation of the MD80-based actuators</p>
</div>
<section id="id2">
<h3>Velocity PID<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>The velocity PID controller can be used to command different velocity profiles to the motor. This mode uses a regular PID controller architecture and has four user-defined parameters: kP, kI, kD, and windup. Since velocity readout is somewhat noisy, it is recommended to keep the kP value as low as possible and play with kI gain. It is necessary to find the sweet spot that makes the actuator response resistant to disturbances, but also not too noisy (too high kP gain may introduce oscillations). Usually, the kI gain is set to a higher value, however, do not treat it as a rule of thumb. Setting the kI gain to a too high value can cause an overshoot when the target velocity is changed rapidly. The kD gain may be used to partially overcome this issue. The windup parameter is used to limit the integral action which could potentially rise to high values when velocity error is present for longer periods.</p>
</section>
<section id="id3">
<h3>Position PID<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Position PID is the mode used when high positioning accuracy is required. Usually, no compliance is assumed in this mode, so the actuator will try to hold the read position as close to the commanded value as possible. One must be aware that position mode is actually made out of two PID controllers - the inner loop which is the velocity PID discussed earlier and the position PID working on top of the velocity loop. This is why it is essential to first take care of the velocity controller, considering the highest velocity that may occur in the system between the corresponding position commands in time. When both high and very low velocities are needed in a system it might be necessary to change the velocity PID gains on the fly, depending on the commanded velocity in each trajectory segment. When the velocity PID is ready the next step is to adjust the position PID gains so that a required actuator response is achieved. Since position readout is much less noisy compared to velocity it is recommended to first pick a kP value that will allow the motor to get to a setpoint position. In the next step kI and kD can be varied, together with the kI limiting factor (windup). One should remember the position PID output limit which is called MaxVelocity. This is a parameter that will limit the maximum commanded velocity and thus may limit actuator performance. It should be set to a value that is close to the actual trajectory segment maximum achievable velocity. Making it too high when very low velocities are required may result in oscillations.</p>
</section>
<section id="id4">
<h3>Impedance PD<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>The impedance mode is relatively straightforward to get started with since there are only two main parameters that affect the response of the actuator. The easiest way is to think of a motor as a combination of a torsional spring with a damper, where kP is the spring constant, and kD is the damping coefficient. The higher the kP gain the more accurate positioning is achieved, but also, when it’s set too high oscillations may be introduced. This is why a damping coefficient should be introduced. It makes the response “smooth”, usually less aggressive, and minimizes overshoot. It can be thought of as placing the motor in a viscous fluid where the viscosity of the fluid is the damping coefficient. This mode, however, can introduce steady-state error due to the lack of integral term. If high positioning accuracy is needed be sure to read about position PID mode.</p>
</section>
<section id="current-pi">
<h3>Current PI<a class="headerlink" href="#current-pi" title="Permalink to this headline">#</a></h3>
<p>Current/torque PI is the lowest-level controller. Its gains are not directly user-configurable, however, they can be modified using the bandwidth parameter. Please see the calibration section for more insight on the topic.</p>
</section>
</section>
<section id="safety-limits">
<span id="id5"></span><h2>Safety limits<a class="headerlink" href="#safety-limits" title="Permalink to this headline">#</a></h2>
<p>There are safety limits imposed on the maximum phase current as well as maximum torque and velocity to ensure the safe operation of the drive. Safety limits are there to protect the controller and the motor from overheating and the surrounding environment from too-powerful actuator movements.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Setting the max current limit to above the maximum continuous current may damage the MD80 controller if the maximum torque is commanded for a prolonged period.</p>
</div>
<p>Let’s start with the max current limit:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/safety_limits.png" />
</figure>
<p>This setting limits the maximum current (and thus torque) the motor can output. It is the last user-configurable limit in the control scheme. The maximum current is set using the <a class="reference internal" href="Software.html#mdtool-config-current"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">config</span> <span class="pre">current</span></code></span></a> command, and by default, it is usually set to 10A. This setting can be saved in the non-volatile memory so that it is always loaded on the actuator power-up. To estimate the maximum current setting for a particular motor, you should use the following formula:</p>
<div class="math notranslate nohighlight">
\[I [A] = \frac{\tau [Nm] \frac{1}{G_r}}{K_t[\frac{Nm}{A}]}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( I[A] \)</span> - calculated current in Amps</p></li>
<li><p><span class="math notranslate nohighlight">\( \tau \)</span> - desired maximum torque</p></li>
<li><p><span class="math notranslate nohighlight">\( G_r \)</span> - gear ratio</p></li>
<li><p><span class="math notranslate nohighlight">\( K_t \)</span> - motor’s torque constant</p></li>
</ul>
<p>for example let’s calculate the max current limit for AK80-9 motor, for a 2Nm max torque:</p>
<p><span class="math notranslate nohighlight">\(\tau = 2 Nm\)</span></p>
<p><span class="math notranslate nohighlight">\(G_r = 9:1 -&gt; 9\)</span></p>
<p><span class="math notranslate nohighlight">\(K_t = 0.091 Nm/A\)</span></p>
<p><span class="math notranslate nohighlight">\( I [A] = \frac{2[Nm] \cdot \frac{1}{9}}{0.091[\frac{Nm}{A}]} \)</span></p>
<p><span class="math notranslate nohighlight">\( I [A] \approx  2.44A \)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Usually this limit should be set to the highest peak torque that is allowed in the system so that it doesn’t limit the actuator performance.</p>
</div>
<p>Now, to put this value into the MD80 please refer to <a class="reference internal" href="Software.html#mdtool-config-current"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">config</span> <span class="pre">current</span></code></span></a> command. Don’t forget to save it with the <a class="reference internal" href="Software.html#mdtool-config-save"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">config</span> <span class="pre">save</span></code></span></a> command.</p>
<p>The other limits are the max torque and max velocity parameters, which are set from the user script level:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/safety_limits2.png" />
</figure>
<p>These parameters allow restricting the output of high-level controllers - the position PID, velocity PID, and impedance PD controllers. These limits are applied before the max current limit, so even when set high they will not lead to a hazardous situation until the max current is fixed at a safe level. The max velocity limit is respected only in position PID mode, whereas the max torque limit is respected in all motion modes. Check out the <a class="reference internal" href="#motion-controller-tuning"><span class="std std-ref">controller tuning</span></a> section for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if the torque bandwidth is set to a low value it is possible to read torque values that are above limits when external torque is applied (for example during impacts). This is only true in transition states - when the load is constant the limits will work as expected. This is because with low torque bandwidth the internal torque PI controllers may be too slow to compensate for rapidly changing torque setpoint when hitting the torque/current limit. If you care about accurate torque readout be sure to play with the torque bandwidth parameter and possibly increase it from the default level.</p>
</div>
</section>
<section id="fdcan-watchdog">
<h2>FDCAN Watchdog<a class="headerlink" href="#fdcan-watchdog" title="Permalink to this headline">#</a></h2>
<p>MD80 features an FDCAN Watchdog Timer. This timer will shut down the drive stage when no FDCAN frame has been received in a specified time. This is to protect the drive and its surroundings in an event of loss of communications, for example by physical damage to the wiring. By default, the watchdog is set to 250ms. This time can be set to any value in the range of 1 to 2000ms using <a class="reference internal" href="Software.html#mdtool-config-can"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">config</span> <span class="pre">can</span></code></span></a> command. When the watchdog is set to 0, it will disable the timer, however, this can lead to dangerous situations, and it is not a recommended way of operating MD80.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>we do not recommend disabling the CAN watchdog timer.</p>
</div>
</section>
<section id="measurements">
<h2>Measurements<a class="headerlink" href="#measurements" title="Permalink to this headline">#</a></h2>
<p>MD80 is equipped with sensors that allow for measuring the motor position, velocity, and torque. Whether the motor has an integrated gearbox or not, <strong>the position, velocity, and torque</strong> are in the output shaft reference frame. This means that changing the position from 0.0 to 2<span class="math notranslate nohighlight">\(\pi\)</span> radians, will result in approximately one rotation of the motor for direct-drive (gearless) servos and approximately one rotation of the gearbox output shaft for geared motors.</p>
<section id="position">
<h3>Position<a class="headerlink" href="#position" title="Permalink to this headline">#</a></h3>
<p>To measure the position of the rotor an MD80 uses an internal magnetic encoder. The resolution of the encoder is 14 bits (16384 counts per rotation). The drive aggregates all the measurements to provide <strong>multi-rotation positional feedback</strong>. The reference position (0.0 rad) is set by the user and stored in the non-volatile memory. Please see <a class="reference internal" href="Software.html#mdtool-config-zero"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">config</span> <span class="pre">zero</span></code></span></a> command for more information on how to set the desired zero position.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using geared actuators with gear ratios above 1:1 it is not possible to determine the position after startup unambiguously, since the motor completes multiple rotations per single rotation of the output shaft. For example, for a 2:1 gearbox, there are two sections within a single output shaft rotation where the motor shaft is in the same position. Unless the motor is placed in the wrong “section” during startup the absolute encoder functionality will work. To deal with this issue please see the <a class="reference internal" href="#output-encoder"><span class="std std-ref">output encoder</span></a>.</p>
</div>
</section>
<section id="velocity">
<h3>Velocity<a class="headerlink" href="#velocity" title="Permalink to this headline">#</a></h3>
<p>The velocity is estimated by measuring position change in time, at a frequency of 40kHz. The measurements are then filtered using a low-pass filter with a cut-off frequency of 5 kHz since the position differentiation method introduces noise.</p>
</section>
<section id="torque">
<h3>Torque<a class="headerlink" href="#torque" title="Permalink to this headline">#</a></h3>
<p>Actuator torque is estimated by measuring motor phase currents. This method can be used on low-gear ratio actuators (preferably below 9:1), that are easily back-drivable, to get an estimate of the torque applied by the motor. In applications with higher gear ratios, the torque readout might be less accurate due to excessive friction in the gearbox.</p>
</section>
</section>
<section id="output-encoder">
<span id="id6"></span><h2>Output Encoder<a class="headerlink" href="#output-encoder" title="Permalink to this headline">#</a></h2>
<p>Output encoder is a position sensor that can be attached to the output shaft of the actuator. It is usually useful for geared motors where the output shaft position after startup cannot be determined unambiguously using the MD80’s onboard encoder due to the gearbox. By using an output encoder one can make sure that the output shaft position is always known at startup.</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/output_encoders.jpg" />
</figure>
<p>Currently we support one encoder type with two placement configurations:</p>
<ul class="simple">
<li><p>AS5047 placed axially on the output shaft with a regular diametrically magnetized magnet</p></li>
</ul>
<figure class="align-center">
<img alt="_images/output_encoder_axial.jpg" class="no-scaled-link" src="_images/output_encoder_axial.jpg" style="width: 300px;" />
</figure>
<ul class="simple">
<li><p>AS5047 placed non-axially together with a diametrically magnetized ring magnet</p></li>
</ul>
<figure class="align-center">
<img alt="_images/output_encoder_offaxis.jpg" class="no-scaled-link" src="_images/output_encoder_offaxis.jpg" style="width: 300px;" />
</figure>
<p>The output encoder configuration is performed in the motor config files and saved to the MD80 using the <a class="reference internal" href="Software.html#mdtool-setup-motor"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">motor</span></code></span></a> command. There are only two parameters used in output encoder setup:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">output</span> <span class="n">encoder</span><span class="p">]</span>
<span class="n">output</span> <span class="n">encoder</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">encoder</span> <span class="nb">type</span><span class="o">&gt;</span>
<span class="n">output</span> <span class="n">encoder</span> <span class="n">mode</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">encoder</span> <span class="n">mode</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where:</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>&lt;encoder type&gt;</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AS5047_CENTER</p></td>
<td><p>for axially placed AS5047 encoder</p></td>
</tr>
<tr class="row-odd"><td><p>AS5047_OFFAXIS</p></td>
<td><p>for non-axially placed AS5047</p></td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>&lt;encoder mode&gt;</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>STARTUP</p></td>
<td><p>initial position from <b><font color="#FFBF00">output encoder</font></b>,
report <b><font color="#008000">main encoder</font></b> values,
motion based on <b><font color="#008000">main encoder</font></b></p></td>
</tr>
<tr class="row-odd"><td><p>MOTION</p></td>
<td><p>initial position from <b><font color="#FFBF00">output encoder</font></b>,
report <b><font color="#FFBF00">output encoder</font></b> values,
motion based on <b><font color="#FFBF00">output encoder</font></b></p></td>
</tr>
<tr class="row-even"><td><p>REPORT</p></td>
<td><p>initial position from <b><font color="#008000">main encoder</font></b>,
report <b><font color="#FFBF00">output encoder</font></b> values,
motion based on <b><font color="#008000">main encoder</font></b>,</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The non-axial configuration outputs a nonlinear position values. This means it requires a <a class="reference internal" href="#output-encoder-calibration"><span class="std std-ref">full calibration</span></a> (your setup should be able to rotate by at least one full rotation), and in case of the report mode it will output nonlinear position and velocity readings that will have to be compensated in high level software</p>
</div>
<p>Not all modes are recommended for every encoder. The non-axially placed AS5047 encoder is inherently more noisy and less accurate and thus we recommend using it only in STARTUP mode. Please refer to the table below:</p>
<table class="table">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>&lt;encoder type&gt;</p></th>
<th class="head"><p>Valid modes</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AS5047_CENTER</p></td>
<td><p>STARTUP / MOTION / REPORT</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>AS5047_OFFAXIS</p></td>
<td><p>STARTUP</p></td>
<td><p>the configuration is much more noisy than the axial placement</p></td>
</tr>
</tbody>
</table>
<p>Steps to add an external encoder to the MD80 setup:</p>
<ul class="simple">
<li><p>make sure the encoder sensor is placed correctly:</p></li>
</ul>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/output_encoder_cross.png" />
</figure>
<ul class="simple">
<li><ul>
<li><p>in case of axially placed sensors make sure they are placed in center at correct height above the magnet (1 mm is usually optimal)</p></li>
<li><p>in case of non-axial configuration make sure the magnet is close to the ring magnet (&lt;0.5mm) and the sensor IC is at least 2mm above or below the ring magnet horizontal plane.</p></li>
</ul>
</li>
<li><p>Connect the MD80 with the encoder using a picoblade series cable assembly and apply voltage to the MD80.</p></li>
<li><p>Modify the motor config file according to your setup and save it to the MD80 using <a class="reference internal" href="Software.html#mdtool"><span class="std std-ref">mdtool</span></a></p></li>
</ul>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/setup_output_encoder.png" />
</figure>
<p>You can confirm the setup using the <a class="reference internal" href="Software.html#mdtool-setup-info"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">info</span></code></span></a> command to make sure all parameters are correct:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/mdtool_setup_info_errors.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point some errors will be present as the setup is not yet calibrated.</p>
</div>
<ul class="simple">
<li><p>Calibrate the MD80 using <a class="reference internal" href="Software.html#mdtool-setup-calibration"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">calibration</span></code></span></a> command</p></li>
<li><p>Calibrate the output encoder using <a class="reference internal" href="Software.html#mdtool-setup-calibration-out"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">calibration_out</span></code></span></a> command</p></li>
<li><p>Test the encoders using <a class="reference internal" href="Software.html#mdtool-test-encoder"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">test</span> <span class="pre">encoder</span></code></span></a> command.</p></li>
<li><p>Use the <a class="reference internal" href="Software.html#mdtool-setup-info"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">info</span></code></span></a> command to make sure there are no errors and the test results (min, max and stddev errors) are within your expectations.</p></li>
<li><p>The external encoder is ready to use! For more information on external encoder parameters please see the <a class="reference internal" href="#output-encoder-calibration"><span class="std std-ref">output encoder calibration</span></a> section.</p></li>
</ul>
</section>
<section id="calibration">
<span id="id7"></span><h2>Calibration<a class="headerlink" href="#calibration" title="Permalink to this headline">#</a></h2>
<p>Calibration should be performed when the MD80 controller is first mounted to the motor or when anything changes in the motor-controller assembly. It has three main stages during which specific parameters of the setup are measured and saved.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The calibration has to be performed on a motor that is free to rotate with no load attached to its output shaft. If the calibration fails, you will see errors when executing the <a class="reference internal" href="Software.html#mdtool-setup-info"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">info</span></code></span></a> command. If the failure is essential to the motor’s operation the MD80 will remain disabled till the next calibration attempt.</p>
</div>
<section id="pole-pairs-detection">
<h3>Pole pairs detection<a class="headerlink" href="#pole-pairs-detection" title="Permalink to this headline">#</a></h3>
<p>In the first stage the motor will execute one full motor rotor rotation in order to check if the pole pair count is correctly configured. If the detected number of pole pairs is not consistent with the number that was typed in the *.cfg file during motor setup the calibration will fail and an error ERROR_POLE_PAIR_DET will be shown until the next calibration attempt. If you are unsure about the number of pole pairs (you can check it by counting magnets and dividing it by 2) just place zero in the *.cfg file. Then the pole pairs will be automatically detected.</p>
</section>
<section id="encoder-eccentricity">
<h3>Encoder eccentricity<a class="headerlink" href="#encoder-eccentricity" title="Permalink to this headline">#</a></h3>
<p>Encoder eccentricity is the second measurement that takes place. During this part, the motor performs a slow single rotation in both directions to assess the amount of error due to non-axial encoder placement.</p>
</section>
<section id="motor-resistance-and-inductance">
<h3>Motor resistance and inductance<a class="headerlink" href="#motor-resistance-and-inductance" title="Permalink to this headline">#</a></h3>
<p>Motor parameters - resistance and inductance are measured in order to calculate the correct current PI controller gains to achieve a certain torque bandwidth (please see the section below). The parameters are measured in the DQ reference frame meaning the resultant resistance and inductance values have to be transformed from either line-to-line quantities or phase quantities.</p>
</section>
<section id="torque-bandwidth">
<h3>Torque bandwidth<a class="headerlink" href="#torque-bandwidth" title="Permalink to this headline">#</a></h3>
<p>Even though the torque command on MD80 controllers seems to be applied instantaneously, in reality, it’s not the case. As in every system, there’s a response to the command which depends on the system itself and the controller gains. A parameter called bandwidth was introduced to describe how fast the output of a system reacts to the changing input. Calibrating the motor for a certain torque bandwidth requires measuring motor parameters. This happens in the last calibration stage and manifests as an audible sound (beep).
The torque bandwidth default setting is set using the motor config file. It can be set to anywhere from 50 Hz to 2.5 kHz, however it is important to note that higher torque bandwidth causes a higher audible noise level. Please see the <a class="reference internal" href="Software.html#mdtool-setup-calibration"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">calibration</span></code></span></a> command for more details on calibrating the actuators.
When the system that you’re designing is a highly dynamic one, you want the torque bandwidth to be higher than the default setting of 50 Hz. Start by calibrating the drives for 1 kHz torque bandwidth, and if you see this is still not enough you can increase it further.</p>
</section>
</section>
<section id="output-encoder-calibration">
<span id="id8"></span><h2>Output Encoder Calibration<a class="headerlink" href="#output-encoder-calibration" title="Permalink to this headline">#</a></h2>
<p>The output encoder calibration routine is used to recognize the correct direction of rotation, and record the correction lookup-table to account for non-axial placement of the encoder in respect to the magnet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The full calibration routine rotates the actuators output shaft by more than one single rotation in the FULL calibration mode. Please make sure the shaft is free to rotate during the test.</p>
</div>
<p>In case your setup is not able to complete a full rotation due to mechanical constraints you can set the <code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">encoder</span> <span class="pre">calibration</span> <span class="pre">mode</span></code> to <code class="docutils literal notranslate"><span class="pre">DIRONLY</span></code> in your *.cfg file in the [output encoder] section. This way the calibration will end on the first stage - checking the correct direction of rotation, so only 1/4 of a full rotation is needed. Please note that this is not possible using off-axis encoder - it requires a full calibration routine.</p>
<figure class="align-center">
<img alt="_images/output_calibration_requirements.png" class="no-scaled-link" src="_images/output_calibration_requirements.png" />
</figure>
<p>To run the routine, use the <a class="reference internal" href="Software.html#mdtool-setup-calibration-out"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">setup</span> <span class="pre">calibration_out</span></code></span></a> command. After completing the routine the MD80 will reboot and after that it is recommended to run the mdtool setup info command in order to make sure the setup reports no errors:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/mdtool_setup_info_allok.png" />
</figure>
<p>The output encoder parameters are rather straightforward, except the “output encoder last check” errors. These values are filled during the output encoder check routine, which can be run using <a class="reference internal" href="Software.html#mdtool-test-encoder"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">test</span> <span class="pre">encoder</span> <span class="pre">output</span></code></span></a>. These params represent the output encoder errors (max, min and standard deviation) with respect to the main encoder mounted on the PCB. This means that if there are large inaccuracies during the calibration, or the output encoder moves in your setup, you can always check how accurate it is by running the check_aux routine.</p>
<p>Example errors for AS5047_CENTER:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/errors_encoder_center.png" />
</figure>
<p>Example errors for AS5047_OFFAXIS:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/errors_encoder_offaxis.png" />
</figure>
<p>As can be seen, the non-axial encoder features larger errors, and thus can be utilized only for initial position determination rather than output shaft control. In case the errors get too large they will turn yellow after running <a class="reference internal" href="Software.html#mdtool-test-encoder"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">mdtool</span> <span class="pre">test</span> <span class="pre">encoder</span> <span class="pre">output</span></code></span></a> command indicating there might be a problem with your setup:</p>
<figure class="align-center">
<img alt="candle" class="no-scaled-link" src="_images/errors_yellow.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These errors will limit the maximum gear ratio that can be used to unambiguously determine the startup output shaft position. Be sure to keep them as low as possible in your setup.</p>
</div>
</section>
<section id="error-codes">
<span id="id9"></span><h2>Error Codes<a class="headerlink" href="#error-codes" title="Permalink to this headline">#</a></h2>
<p>When an abnormal situation takes place the controller sets an error bit indicating a particular error. The table below lists all available error codes and their descriptions.</p>
<p><b>Main / Output Encoder Errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
		<tr>
			<td>ERROR_COMMUNICATION </td>
			<td>0</td>
			<td>MD80 could not communicate with the encoder </td>
      		<td>Check connections </td>
		</tr>
    	<tr>
			<td>ERROR_WRONG_DIRECTION</td>
			<td>1</td>
			<td>Indicates the calibrated output encoder direction is different from the main encoder direction</td>
      		<td>Recalibrate</td>
		</tr>
   		 <tr>
			<td>ERROR_EMPTY_LUT</td>
			<td>2</td>
			<td>Indicates the encoder eccentricity table is empty</td>
      		<td>Recalibrate</td>
		</tr>
    	<tr>
			<td>ERROR_FAULTY_LUT</td>
			<td>3</td>
			<td>Indicates the encoder eccentricity table is faulty (contains too large corrections)</td>
    		<td>Check the setup and recalibrate</td>
		</tr>
    	<tr>
			<td>ERROR_CALIBRATION_FAILED</td>
			<td>4</td>
			<td>Calibration failed due to wrong motor <> encoder setup</td>
			<td>Check setup, recalibrate in case of problems contact MABRobotics</td>
		</tr>
    	<tr>
			<td>ERROR_POSITION_INVALID</td>
			<td>5</td>
			<td>Position reading is invalid</td>
			<td>Check endcoder physical setup, in case of problems contact MABRobotics</td>
		</tr>
		<tr>
			<td>ERROR_INIT</td>
			<td>6</td>
			<td>Encoder initialization failed</td>
			<td>Check endcoder setup and connection, in case of problems contact MABRobotics</td>
		</tr>
		<tr>
			<td>WARNING_LOW_ACCURACY</td>
			<td>30</td>
			<td>Encoder position readout accuracy may be lower than specified</td>
			<td>Check endcoder physical setup and reboot the MD80</td>
		</tr>
	</tbody>
</table>
<p></p>
<p><b>Calibration Errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
		<tr>
			<td>ERROR_OFFSET_CAL </td>
			<td>0</td>
			<td>Problem with the offset determination during calibration </td>
      		<td>Try recalibrating</td>
		</tr>
    	<tr>
			<td>ERROR_RESISTANCE_IDENT</td>
			<td>1</td>
			<td>Problem with resistance identification</td>
    		<td>Try recalibrating or running the `mdtool config bandwidth` command</td>
		</tr>
    	<tr>
			<td>ERROR_INDUCTANCE_IDENT</td>
			<td>2</td>
			<td>Problem with inductance identification</td>
      		<td>Try recalibrating or running the `mdtool config bandwidth` command</td>
		</tr>
    	<tr>
			<td>ERROR_POLE_PAIR_CAL</td>
			<td>3</td>
			<td>Problem with pole pair detection routine</td>
      		<td>Try recalibrating</td>
		</tr>
    	<tr>
			<td>ERROR_SETUP</td>
			<td>4</td>
			<td>Problem with motor config file download</td>
      		<td>Check the config file again and try to upload one more time</td>
		</tr>
	</tbody>
</table>
<p></p>
<p><b>Bridge errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
		<tr>
			<td>ERROR_BRIDGE_COM</td>
			<td>0</td>
			<td>Communication problem with the bridge</td>
      		<td>Contact MABRobotics</td>
		</tr>
    	<tr>
			<td>ERROR_BRIDGE_OC</td>
			<td>1</td>
			<td>The bridge detected overcurrent</td>
      		<td>Lower the current limit, restart the drives</td>
		</tr>
    	<tr>
			<td>ERROR_BRIDGE_GENERAL_FAULT</td>
			<td>2</td>
			<td>Usually indicates a hardware issue</td>
      		<td>Contact MABRobotics</td>
		</tr>
	</tbody>
</table>
<p></p>
<p><b>Hardware errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
   		<tr>
			<td>ERROR_OVER_CURRENT</td>
			<td>0</td>
			<td>Overcurrent detected</td>
      		<td>Lower the current limit, restart the drives</td>
		</tr>
    	<tr>
			<td>ERROR_OVER_VOLTAGE</td>
			<td>1</td>
			<td>Overvoltage detected</td>
      		<td>Lower the system voltage, avoid rapid braking in the system, use a modern PSU, or a LiPo battery</td>
		</tr>
    	<tr>
			<td>ERROR_UNDER_VOLTAGE</td>
			<td>2</td>
			<td>Undervoltage detected</td>
      		<td>Ensure your power supply has enough current capability for your system</td>
		</tr>
    	<tr>
			<td>ERROR_MOTOR_TEMP</td>
			<td>3</td>
			<td>Motor temperature exceeded the limit set in the config file</td>
      		<td>Wait for the motor to cool down</td>
		</tr>
    	<tr>
			<td>ERROR_MOSFET_TEMP</td>
			<td>4</td>
			<td>MD80 power side exceeded the limit of 100*C</td>
      		<td>wait for the MD80 to cool down</td>
		</tr>
     	<tr>
			<td>ERROR_ADC_CURRENT_OFFSETS</td>
			<td>5</td>
			<td>Error during adc current offsets calibration</td>
      		<td>Usually indicates a hardware error - contact MABRobotics</td>
		</tr> 
  </tbody>
</table>
<p></p>
<p><b>Comunication errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
    	<tr>
			<td>WARNING_CAN_WD</td>
			<td>30</td>
			<td>Indicates the communication with the host was ended by the watchdog</td>
      		<td>make sure candle.end() is called in your script</td>
		</tr>
  </tbody>
</table>
<p></p>
<p><b>Motion errors</b></p>
<table border="1" cellpadding="2" cellspacing="0"  class="gridlines sheet0" id="sheet0" style="float:center;text-align:center;font-size:11px ;width:100%">
	<tbody>
		<tr>
			<td> <b>Error name</b></td>
			<td> <b>Error bit</b></td>
			<td> <b>Error description</b></td>
      		<td> <b>Action to clear it</b></td>
		</tr>
    	<tr>
			<td>WARNING_TORQUE_CLIPPED</td>
			<td>25</td>
			<td>Torque command was clipped to max torque at least once</td>
      		<td>Check torque limits</td>
		</tr>
    	<tr>
			<td>WARNING_VELOCITY_CLIPPED</td>
			<td>26</td>
			<td>Velocity command was clipped to max velocity at least once</td>
      		<td>Check velocity limits</td>
		</tr>
    	<tr>
			<td>WARNING_POSITON_CLIPPED</td>
			<td>27</td>
			<td>Position command was clipped to either max or min position at least once</td>
      		<td>Check position limits</td>
		</tr>
    	<tr>
			<td>WARNING_START_OUTSIDE_LIMITS</td>
			<td>28</td>
			<td>Attempted to move when motor shaft was outside the position limits</td>
      		<td>Check position limits and current shaft position</td>
		</tr>
  </tbody>
</table>
<p></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Ecosystem.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Ecosystem overview</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="CANdle.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">CANdle and CANdle HAT</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By MAB Robotics<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>